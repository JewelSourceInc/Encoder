<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SKU Encoder</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page-wrapper">
    <!-- Shared Header -->
    <header class="site-header">
      <div class="header-inner">
        <!-- Centered logo row -->
        <div class="header-row header-row-top">
          <img
            src="Resources/logo-dark.png"
            alt="Logo"
            class="header-logo"
          />
        </div>

        <!-- Navigation row (right-aligned) -->
        <div class="header-row header-row-bottom">
          <nav class="main-nav">
            <a href="index.html" class="nav-link active">Encoder</a>
            <a href="decoder.html" class="nav-link">Decoder</a>
          </nav>
        </div>
      </div>
    </header>



    <main class="site-main">
      <section class="panel">
        <h1 class="panel-title">Encoder</h1>

        <div class="panel-columns">
          <!-- Input section -->
          <section class="panel-block">
            <h2 class="block-title">Input</h2>

            <form class="encoder-form" onsubmit="event.preventDefault(); generateEncodedSKU();">
              <!-- Stone Type -->
              <div class="field-group">
                <label class="field-label" for="stone">Stone Type</label>
                <select id="stone" class="oval-select">
                  <option value="J">Mined (J)</option>
                  <option value="A">Lab Grown (A)</option>
                  <option value="G">Gemstone (G)</option>
                  <option value="Z">Lab Created (Z)</option>
                </select>
              </div>

              <!-- Gemstone sub-category (shown only when stone type = Gemstone) -->
              <div class="field-group" id="gemstone-group" style="display: none;">
                <label class="field-label" for="gemstone">Gemstone</label>
                <select id="gemstone" class="oval-select">
                  <option value="">Select gemstone</option>
                  <option value="ABA">ABALONE (ABA)</option>
                  <option value="AGT">AGATE (AGT)</option>
                  <option value="ALE">ALEXANDRITE (ALE)</option>
                  <option value="ALX">ALEXITE (ALX)</option>
                  <option value="ALO">ALONITE (ALO)</option>
                  <option value="AMZ">AMAZONITE (AMZ)</option>
                  <option value="AME">AMETHYST (AME)</option>
                  <option value="AMT">AMETRINE (AMT)</option>
                  <option value="ANG">ANGELITE (ANG)</option>
                  <option value="APT">APATITE (APT)</option>
                  <option value="AQM">AQUAMARINE (AQM)</option>
                  <option value="BRY">BERYL (BRY)</option>
                  <option value="BCF">BI-CLR-FLUORITE (BCF)</option>
                  <option value="BAM">BI-COLOR AMETRINE (BAM)</option>
                  <option value="BTP">BLUE TOPAZ (BTP)</option>
                  <option value="CCZ">CANARY CZ (CCZ)</option>
                  <option value="CNL">CANELIAN (CNL)</option>
                  <option value="CRL">CARNELIAN (CRL)</option>
                  <option value="CEY">CAT'S EYE (CEY)</option>
                  <option value="CER">CERAMIC (CER)</option>
                  <option value="CES">CEYLON SAPPHIRE (CES)</option>
                  <option value="CHL">CHALCEDONY (CHL)</option>
                  <option value="CHR">CHAROITE (CHR)</option>
                  <option value="CHM">CHROME (CHM)</option>
                  <option value="CHD">CHROME DIOPSIDE (CHD)</option>
                  <option value="CHY">CHRYSOCOLLA (CHY)</option>
                  <option value="CIT">CITRINE (CIT)</option>
                  <option value="CQZ">COGNAC QTZ (CQZ)</option>
                  <option value="CPE">COIN PEARL (CPE)</option>
                  <option value="COR">CORAL (COR)</option>
                  <option value="CAL">CREATED ALEXANDRITE (CAL)</option>
                  <option value="CAM">CREATED AMETHYST (CAM)</option>
                  <option value="CAQ">CREATED AQUAMARINE (CAQ)</option>
                  <option value="CCT">CREATED CITRINE (CCT)</option>
                  <option value="CEM">CREATED EMERALD (CEM)</option>
                  <option value="CEO">CREATED ETHOPIAN OPAL</option>
                  <option value="CGT">CREATED GARNET (CGT)</option>
                  <option value="COP">CREATED OPAL (COP)</option>
                  <option value="CPD">CREATED PERIDOT (CPD)</option>
                  <option value="CSP">CREATED SAPPHIRE (CSP)</option>
                  <option value="CTP">CREATED TOPAZ (CTP)</option>
                  <option value="CWO">CREATED WHITE OPAL (CWO)</option>
                  <option value="CRB">CREATEDRUBY (CRB)</option>
                  <option value="CRY">CRYSTAL (CRY)</option>
                  <option value="CZR">CUBIC ZIRCONIA (CZR)</option>
                  <option value="CZS">CZ SAPPHIRE (CZS)</option>
                  <option value="DSP">DIFFUSED SAPPHIRE (DZP)</option>
                  <option value="EMR">EMERALD (EMR)</option>
                  <option value="EOP">ETHOPIAN OPAL (EOP)</option>
                  <option value="FOP">FIRE OPAL (FOP)</option>
                  <option value="FZI">FIRE ZIRCON (FZI)</option>
                  <option value="FLR">FLORITE (FLR)</option>
                  <option value="GAR">GARNET (GAR)</option>
                  <option value="GLS">GLASS (GLS)</option>
                  <option value="GRN">GRANDIDIERITE (GRN)</option>
                  <option value="GGT">GRAPE GARNET (GGT)</option>
                  <option value="GRS">GRASS (GRS)</option>
                  <option value="HEL">HELENITE (HEL)</option>
                  <option value="HES">HESSONITE (HES)</option>
                  <option value="HID">HIDDENITE (HID)</option>
                  <option value="HOW">HOWLITE (HOW)</option>
                  <option value="IND">INDICOLITE (IND)</option>
                  <option value="IOL">IOLITE (IOL)</option>
                  <option value="JAD">JADE (JAD)</option>
                  <option value="JSP">JASPER (JSP)</option>
                  <option value="KPE">KESHI PEARL (KPE)</option>
                  <option value="KUN">KUNZITE (KUN)</option>
                  <option value="KYN">KYANITE (KYN)</option>
                  <option value="LBD">LABRADORITE (LBD)</option>
                  <option value="LAP">LAPIS (LAP)</option>
                  <option value="LAM">LARIMAR (LAM)</option>
                  <option value="LAV">LARVIKITE (LAV)</option>
                  <option value="LBT">LONDON BLUE TOPAZ (LBT)</option>
                  <option value="MCT">MADEIRA CITRINE (MCT)</option>
                  <option value="MAL">MALACHITE (MAL)</option>
                  <option value="MAN">MANDARINE (MAN)</option>
                  <option value="MAQ">MILKY AQUA (MAQ)</option>
                  <option value="MNG">MING (MNG)</option>
                  <option value="MZI">MOCHA ZIRCON (MZI)</option>
                  <option value="MOS">MOISSANITE (MOS)</option>
                  <option value="MOL">MOLDAVITE (MOL)</option>
                  <option value="MST">MOONSTONE (MST)</option>
                  <option value="MOP">MOP (MOP)</option>
                  <option value="MOR">MORGANITE (MOR)</option>
                  <option value="MCZ">MORGANITE CZ (MCZ)</option>
                  <option value="MTO">MULTI TOURMALINE (MTO)</option>
                  <option value="NEO">NEON STONES (NEO)</option>
                  <option value="ONX">ONYX (ONZ)</option>
                  <option value="OPL">OPAL (OPL)</option>
                  <option value="ORT">ORTHOCLASE (ORT)</option>
                  <option value="PAR">PARIBA (PAR)</option>
                  <option value="PBA">PARIBA APATITE (PBA)</option>
                  <option value="PAS">PASIOLITE (PAS)</option>
                  <option value="PRL">PEARL (PRL)</option>
                  <option value="PER">PERIDOT (PER)</option>
                  <option value="PET">PETALITE (PET)</option>
                  <option value="POP">PINK OPAL (POP)</option>
                  <option value="PTP">PINK TOPAZ (PTP)</option>
                  <option value="PRA">PRASEOLITE (PRA)</option>
                  <option value="QTZ">QUARTZ (QTZ)</option>
                  <option value="RHO">RHODOLITE (RHO)</option>
                  <option value="RHN">RHODONITE (RHN)</option>
                  <option value="RRP">RIVER ROCK PEARL (RRP)</option>
                  <option value="RQZ">ROSE QUARTZ (RQZ)</option>
                  <option value="RBE">RUBELLITE (RBE)</option>
                  <option value="RUB">RUBY (RUB)</option>
                  <option value="SAQ">SANTA AQUAMARINE (SAQ)</option>
                  <option value="SAP">SAPPHIRE (SAP)</option>
                  <option value="SCP">SCAPOLITE (SCP)</option>
                  <option value="SIM">SILLIMANITE (SIM)</option>
                  <option value="SIL">SILLIMITE (SIL)</option>
                  <option value="SQZ">SMOKY QUARTZ (SQZ)</option>
                  <option value="SPA">SPALERITER (SPA)</option>
                  <option value="SPS">SPESSARTITE (SPS)</option>
                  <option value="SPH">SPHALERITE (SPH)</option>
                  <option value="SPN">SPHENE (SPN)</option>
                  <option value="SPI">SPINAL (SPI)</option>
                  <option value="SKY">SKY BLUE TOPAZ (SKY)</option>
                  <option value="SWS">SWISS BLUE TOPAZ (SWS)</option>
                  <option value="SCO">SPINY CORAL (SCO)</option>
                  <option value="SGC">SPONGE CORAL (SGC)</option>
                  <option value="SCA">SWA CRYSTAL AMETHYST (SCA)</option>
                  <option value="SCQ">SWA CRYSTAL AQUAMARINE (SCQ)</option>
                  <option value="SCC">SWA CRYSTAL CRYSTAL (SCC)</option>
                  <option value="SCE">SWA CRYSTAL EMERALD (SCE)</option>
                  <option value="SLA">SWA CRYSTAL LIGHT AMETHYST (SLA)</option>
                  <option value="SLS">SWA CRYSTAL LIGHT SAPPHIRE (SLS)</option>
                  <option value="SLI">SWA CRYSTAL LIGHT SIAM (SLI)</option>
                  <option value="SCP">SWA CRYSTAL PERIDOT (SCP)</option>
                  <option value="SCR">SWA CRYSTAL ROSE (SCR)</option>
                  <option value="SRB">SWA CRYSTAL RUBY (SRB)</option>
                  <option value="SCS">SWA CRYSTAL SAPPHIRE (SCS)</option>
                  <option value="SCT">SWA CRYSTAL TOPAZ (SCT)</option>
                  <option value="SCZ">SWA CZ RUBY (SCZ)</option>
                  <option value="SWC">SWAROVSKI CZ (SWC)</option>
                  <option value="SWB">SWISS BLUE (SWB)</option>
                  <option value="TAN">TANZANITE (TAN)</option>
                  <option value="TIG">TIGER (TIG)</option>
                  <option value="TPZ">TOPAZ (TPZ)</option>
                  <option value="TOU">TOURMALINE (TOU)</option>
                  <option value="TSV">TSAVORITE(TZV)</option>
                  <option value="TUR">TURKIZITE (TUR)</option>
                  <option value="TRQ">TURQUOISE (TRQ)</option>
                  <option value="WTP">WHITE TOPAZ (WTP)</option>
                  <option value="WZI">WHITE ZIRCON (WZI)</option>
                  <option value="ZRC">ZIRCON (ZRC)</option>
                  <option value="ZUL">ZULTANITE (ZUL)</option>
                </select>
              </div>

              <div class="field-group" id="gem-carat-group" style="display: none;">
                <label class="field-label" for="gem-carat">Carat (If applicable)</label>
                <input
                  id="gem-carat"
                  type="number"
                  class="rect-input"
                  step="0.01"
                  min="0.10"
                  max="99"
                  placeholder="0.10 to 99.00"
                />
              </div>


              <!-- Carat input (shown when stone type is NOT gemstone) -->
              <div class="field-group" id="carat-group" style="display: none;">
                <label class="field-label" for="carat">Carat</label>
                <input
                  id="carat"
                  type="number"
                  class="rect-input"
                  step="0.01"
                  min="0.10"
                  max="99"
                  placeholder="0.10 to 99.00"
                />
              </div>


              <!-- Style + Size (unchanged) -->
              <div class="field-group">
                <label class="field-label" for="style">Style</label>
                <select id="style" class="oval-select">
                  <option value="">Select style</option>
                  <option value="E">Earring (E)</option>
                  <option value="P">Pendant (P)</option>
                  <option value="N">Necklace (N)</option>
                  <option value="R">Ring (R)</option>
                  <option value="B">Bangle/Bracelet (B)</option>
                  <option value="S">Set (S)</option>
                </select>
              </div>

              <div class="field-group" id="sub-category-group" style="display: none;">
                <label class="field-label" for="sub-category">Size</label>
                <select id="sub-category" class="oval-select">
                  <option value="">Select size</option>
                  <!-- Necklace sizes -->
                  <option value="A" data-parent="N">16 inches (A)</option>
                  <option value="B" data-parent="N">17 inches (B)</option>
                  <option value="C" data-parent="N">18 inches (C)</option>
                  <option value="D" data-parent="N">20 inches (D)</option>
                  <option value="E" data-parent="N">22 inches (E)</option>
                  <option value="F" data-parent="N">24 inches (F)</option>
                  <!-- Ring sizes -->
                  <option value="A" data-parent="R">4 (A)</option>
                  <option value="B" data-parent="R">4.5 (B)</option>
                  <option value="C" data-parent="R">5 (C)</option>
                  <option value="D" data-parent="R">5.5 (D)</option>
                  <option value="E" data-parent="R">6 (E)</option>
                  <option value="F" data-parent="R">6.5 (F)</option>
                  <option value="G" data-parent="R">7 (G)</option>
                  <option value="H" data-parent="R">7.5 (H)</option>
                  <option value="I" data-parent="R">8 (I)</option>
                  <option value="J" data-parent="R">8.5 (J)</option>
                  <option value="K" data-parent="R">9 (K)</option>
                  <option value="L" data-parent="R">9.5 (L)</option>
                  <option value="M" data-parent="R">10 (M)</option>
                  <option value="N" data-parent="R">10.5 (N)</option>
                  <option value="O" data-parent="R">11 (O)</option>
                  <option value="P" data-parent="R">11.5 (P)</option>
                  <option value="Q" data-parent="R">12 (Q)</option>
                  <!-- Bangle/Bracelet sizes -->
                  <option value="A" data-parent="B">6 inches (A)</option>
                  <option value="B" data-parent="B">6.25 inches (B)</option>
                  <option value="C" data-parent="B">6.5 inches (C)</option>
                  <option value="D" data-parent="B">7 inches (D)</option>
                  <option value="E" data-parent="B">7.25 inches (E)</option>
                  <option value="F" data-parent="B">7.5 inches (F)</option>
                  <option value="G" data-parent="B">8 inches (G)</option>
                </select>
              </div>

              <!-- Metal Type + Metal Option -->
              <div class="field-group">
                <label class="field-label" for="metal-type">Metal Type</label>
                <select id="metal-type" class="oval-select">
                  <option value="">Select metal type</option>
                  <option value="10KT">10KT</option>
                  <option value="14KT">14KT</option>
                  <option value="18KT">18KT</option>
                  <option value="9KT">9KT</option>
                  <option value="SIL">Silver</option>
                  <option value="PLT">Platinum</option>
                  <option value="SPC">Special</option>
                </select>
              </div>

              <div class="field-group" id="metal-option-group" style="display: none;">
                <label class="field-label" for="metal-option">Metal</label>
                <select id="metal-option" class="oval-select">
                  <option value="">Select metal</option>

                  <!-- 10KT -->
                  <option value="A" data-parent="10KT">10KY - YELLOW (A)</option>
                  <option value="B" data-parent="10KT">10KW - WHITE (B)</option>
                  <option value="C" data-parent="10KT">10KR - ROSE (C)</option>
                  <option value="D" data-parent="10KT">10KTT - TWO-TONE (D)</option>

                  <!-- 14KT -->
                  <option value="P" data-parent="14KT">14KY - YELLOW (P)</option>
                  <option value="Q" data-parent="14KT">14KW - WHITE (Q)</option>
                  <option value="R" data-parent="14KT">14KR - ROSE (R)</option>
                  <option value="T" data-parent="14KT">14KTT - TWO-TONE (T)</option>

                  <!-- 18KT -->
                  <option value="E" data-parent="18KT">18KY - YELLOW (E)</option>
                  <option value="F" data-parent="18KT">18KW - WHITE (F)</option>
                  <option value="G" data-parent="18KT">18KR - ROSE (G)</option>
                  <option value="H" data-parent="18KT">18KR - TWO-TONE (H)</option>

                  <!-- 9KT -->
                  <option value="X" data-parent="9KT">9KY - YELLOW (X)</option>
                  <option value="Y" data-parent="9KT">9KW - WHITE (Y)</option>
                  <option value="Z" data-parent="9KT">9KR - ROSE (Z)</option>
                  <option value="W" data-parent="9KT">9KTT - TWO-TONE (W)</option>

                  <!-- SILVER -->
                  <option value="J" data-parent="SIL">RPS - RHODIUM PLATED (J)</option>
                  <option value="K" data-parent="SIL">YPS - YELLOW PLATED (K)</option>
                  <option value="L" data-parent="SIL">ROS - ROSE PLATED (L)</option>
                  <option value="M" data-parent="SIL">TTPS - TWO-TONED PLATED (M)</option>
                  <option value="N" data-parent="SIL">3TPS - THREE-TONED PLATED (N)</option>

                  <!-- Platinum -->
                  <option value="U" data-parent="PLT">PLAT - Platinum (U)</option>

                  <!-- Special -->
                  <option value="S" data-parent="SPC">SPEC - Special (S)</option>
                </select>
              </div>

              <!-- Unique Identifier -->
              <div class="field-group">
                <label class="field-label" for="unique-id">Enter Unique Identifier</label>
                <input
                  id="unique-id"
                  type="text"
                  class="rect-input"
                  maxlength="6"
                  pattern="[A-Za-z0-9]{0,6}"
                  placeholder="Up to 6 characters"
                />
              </div>

              <div id="sku-error" class="error-message" style="display: none;">
              <!-- Error text will be injected here -->
              </div>


              <!-- Generate button -->
              <button type="submit" class="primary-button full-width">
                Generate
              </button>
            </form>

          </section>

          <!-- Output section -->
          <section class="panel-block">
            <h2 class="block-title">Output</h2>

            <!-- Blue box that shows output -->
            <div class="output-card">
              <div id="encoder-output" class="output-text">
                Generated SKU will appear here.
              </div>

              <!-- Copy text bottom-right -->
              <button
                type="button"
                class="copy-button"
                onclick="copyEncoderOutput()"
              >
                Copy
              </button>
            </div>
          </section>
        </div>
      </section>
    </main>
  </div>

  <!-- javaScript Start -->
  <script>
    const MAX_SKU_LENGTH = 13;

    // ---- Utility: format carat to 3 char string ----
    function formatCaratTo3Chars(rawValue) {
      if (!rawValue) return '000';

      const value = parseFloat(rawValue);
      if (Number.isNaN(value) || value <= 0) return '000';

      if (value < 10) {
        // 0.10 -> "010", 8.5 -> "850"
        const scaled = Math.round(value * 100); // two decimals
        return String(scaled).padStart(3, '0'); // ensure 3 chars [web:17][web:19]
      }

      // 10 or more: 12.00 -> "12T", 13.5 -> "13T"
      const whole = Math.floor(value);
      const code = String(whole) + 'T';

      // For values like 100+, still keep only 3 chars
      return code.slice(0, 3);
    }

    // ---- Generate SKU ----
    function generateEncodedSKU() {
    // Clear previous error state
    const errorBox = document.getElementById('sku-error');
    errorBox.style.display = 'none';
    errorBox.textContent = '';

    const errorFields = document.querySelectorAll('.field-error');
    errorFields.forEach((el) => el.classList.remove('field-error'));

    // 1: STONE TYPE
    const stoneEl = document.getElementById('stone');
    const stone = (stoneEl.value || '').trim();

    // 2: STYLE
    const styleEl = document.getElementById('style');
    const style = (styleEl.value || '').trim();

    // 3–5: CARAT OR GEMSTONE
    const gemstoneGroup = document.getElementById('gemstone-group');
    const caratGroup = document.getElementById('carat-group');
    const gemstoneEl = document.getElementById('gemstone');
    const caratEl = document.getElementById('carat');

    let gemstoneCode = '';
    let caratCodeRaw = '';

    if (gemstoneGroup && gemstoneGroup.style.display !== 'none') {
      gemstoneCode = (gemstoneEl.value || '').trim();
    } else if (caratGroup && caratGroup.style.display !== 'none') {
      caratCodeRaw = (caratEl.value || '').trim();
    }

    // 4: METAL option
    const metalOptionGroup = document.getElementById('metal-option-group');
    const metalOptionEl = document.getElementById('metal-option');
    let metalOption = '';
    if (metalOptionGroup && metalOptionGroup.style.display !== 'none') {
      metalOption = (metalOptionEl.value || '').trim();
    }

    // 5: UNIQUE IDENTIFIER
    const uniqueInput = document.getElementById('unique-id');
    let uniqueIdRaw = (uniqueInput.value || '').trim();

    // 6: SIZE (conditionally required)
    const subCatGroup = document.getElementById('sub-category-group');
    const subCatEl = document.getElementById('sub-category');
    let size = '';
    if (subCatGroup && subCatGroup.style.display !== 'none') {
      size = (subCatEl.value || '').trim();
    }

    const missing = [];

    // Always required
    if (!stone) {
      missing.push('Stone Type');
      stoneEl.classList.add('field-error');
    }

    if (!style) {
      missing.push('Style');
      styleEl.classList.add('field-error');
    }

    // Either gemstone OR carat required
    if (!gemstoneCode && !caratCodeRaw) {
      missing.push('Carat / Gemstone');
      if (gemstoneGroup && gemstoneGroup.style.display !== 'none') {
        gemstoneEl.classList.add('field-error');
      } else if (caratGroup && caratGroup.style.display !== 'none') {
        caratEl.classList.add('field-error');
      }
    }

    if (!metalOption) {
      missing.push('Metal');
      metalOptionEl.classList.add('field-error');
    }

    if (!uniqueIdRaw) {
      missing.push('Unique Identifier');
      uniqueInput.classList.add('field-error');
    }

    // Size required only when style is Necklace (N), Ring (R), or Bangle/Bracelet (B)
    const styleNeedsSize = ['N', 'R', 'B'].includes(style);
    if (styleNeedsSize) {
      if (!size) {
        missing.push('Size');
        if (subCatGroup && subCatGroup.style.display !== 'none') {
          subCatEl.classList.add('field-error');
        }
      }
    }

    if (missing.length > 0) {
      // Show inline error above Generate button
      errorBox.textContent =
        'Please fill all required fields: ' + missing.join(', ');
      errorBox.style.display = 'block';

      document.getElementById('encoder-output').textContent =
        'Generated SKU will appear here.';
      return;
    }

    // ---- All required fields present, build SKU ----

    // 1: stone (1 char)
    const stoneChar = stone.slice(0, 1);

    // 2: style (1 char)
    const styleChar = style.slice(0, 1);

    // 3–5: carat or gemstone (3 chars)
    let pos3to5 = '000';
    if (gemstoneCode) {
      pos3to5 = gemstoneCode.slice(0, 3);
    } else {
      pos3to5 = formatCaratTo3Chars(caratCodeRaw);
    }

    // 6: metal option (1 char)
    const pos6 = metalOption.slice(0, 1);

    // 7–12: unique ID (6 chars)
    let uniqueId = uniqueIdRaw.toUpperCase().replace(/[^A-Z0-9]/g, '');
    if (uniqueId.length > 6) {
      uniqueId = uniqueId.slice(0, 6);
    } else {
      uniqueId = uniqueId.padEnd(6, 'X'); // pad if shorter [web:17][web:19]
    }

    // 13: size (1 char) or X if not applicable
    let pos13;
    if (styleNeedsSize) {
      pos13 = size.slice(0, 1); // already checked non-empty
    } else {
      pos13 = 'X';
    }

    const raw =
      stoneChar +   // 1
      styleChar +   // 2
      pos3to5 +     // 3-5
      pos6 +        // 6
      uniqueId +    // 7-12
      pos13;        // 13

    const finalSku = raw.slice(0, 13);
    document.getElementById('encoder-output').textContent = finalSku;
  }




    function copyEncoderOutput() {
      const text = document.getElementById('encoder-output').textContent.trim();
      if (!text) return;
      navigator.clipboard.writeText(text).catch(() => {});
    }

    document.addEventListener('DOMContentLoaded', function () {
      // ----- Style -> Size dropdown -----
      const styleSelect = document.getElementById('style');
      const subCategoryGroup = document.getElementById('sub-category-group');
      const subCategorySelect = document.getElementById('sub-category');
      const allSubOptions = Array.from(subCategorySelect.options);

      function updateSubCategoryVisibility() {
        const mainValue = styleSelect.value;
        const hasSize = ['N', 'R', 'B'].includes(mainValue);

        if (!hasSize) {
          subCategoryGroup.style.display = 'none';
          subCategorySelect.value = '';
          return;
        }

        subCategoryGroup.style.display = 'block';

        allSubOptions.forEach((opt) => {
          const parent = opt.getAttribute('data-parent');
          if (!parent) {
            opt.hidden = false;
            return;
          }
          opt.hidden = parent !== mainValue;
        });

        subCategorySelect.value = '';
      }

      styleSelect.addEventListener('change', updateSubCategoryVisibility);
      updateSubCategoryVisibility();

      // ----- Stone Type -> Gemstone vs Carat + Gem Carat field -----
      const stoneSelect = document.getElementById('stone');
      const gemstoneGroup = document.getElementById('gemstone-group');
      const gemstoneSelect = document.getElementById('gemstone');
      const caratGroup = document.getElementById('carat-group');
      const caratInput = document.getElementById('carat');

      const gemCaratGroup = document.getElementById('gem-carat-group');
      const gemCaratInput = document.getElementById('gem-carat');

      function updateStoneDetails() {
        const stoneValue = stoneSelect.value;

        if (stoneValue === 'G') {
          // Gemstone selected
          gemstoneGroup.style.display = 'block';
          gemCaratGroup.style.display = 'block';  // show "Carat (If applicable)"
          caratGroup.style.display = 'none';
          caratInput.value = '';
        } else {
          // Non-gemstone: use main Carat input
          gemstoneGroup.style.display = 'none';
          gemstoneSelect.value = '';
          gemCaratGroup.style.display = 'none';
          gemCaratInput.value = '';
          caratGroup.style.display = 'block';
        }
      }

      stoneSelect.addEventListener('change', updateStoneDetails);
      updateStoneDetails();

      // ----- Metal Type -> Metal Option -----
      const metalTypeSelect = document.getElementById('metal-type');
      const metalOptionGroup = document.getElementById('metal-option-group');
      const metalOptionSelect = document.getElementById('metal-option');
      const allMetalOptions = Array.from(metalOptionSelect.options);

      function updateMetalOptions() {
        const typeValue = metalTypeSelect.value;

        if (!typeValue) {
          metalOptionGroup.style.display = 'none';
          metalOptionSelect.value = '';
          return;
        }

        metalOptionGroup.style.display = 'block';

        allMetalOptions.forEach((opt) => {
          const parent = opt.getAttribute('data-parent');
          if (!parent) {
            opt.hidden = false;
            return;
          }
          opt.hidden = parent !== typeValue;
        });

        metalOptionSelect.value = '';
      }

      metalTypeSelect.addEventListener('change', updateMetalOptions);
      updateMetalOptions();
    });
  </script>

</body>
</html>



